<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sector Rotation Dashboard | Market Analytics</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --bg-primary: #0a0e14;
            --bg-secondary: #131a24;
            --bg-tertiary: #1c2632;
            --border-color: #2a3544;
            --text-primary: #e6edf3;
            --text-secondary: #7d8590;
            --accent-blue: #2f81f7;
            --accent-green: #3fb950;
            --accent-red: #f85149;
            --accent-yellow: #d29922;
            --accent-purple: #a371f7;
            --accent-cyan: #39c5cf;
            --accent-orange: #f0883e;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            min-height: 100vh;
        }

        .container {
            max-width: 1800px;
            margin: 0 auto;
            padding: 20px;
        }

        /* Header */
        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 16px;
            border-bottom: 1px solid var(--border-color);
        }

        .header h1 {
            font-size: 22px;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .header-meta {
            display: flex;
            align-items: center;
            gap: 20px;
        }

        .last-update {
            color: var(--text-secondary);
            font-size: 13px;
        }

        .market-status {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 13px;
        }

        .status-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: var(--accent-green);
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        .btn {
            padding: 8px 16px;
            border-radius: 6px;
            border: 1px solid var(--border-color);
            background: var(--bg-tertiary);
            color: var(--text-primary);
            cursor: pointer;
            font-size: 13px;
            transition: all 0.2s;
        }

        .btn:hover {
            background: var(--bg-secondary);
            border-color: var(--text-secondary);
        }

        /* Main Grid */
        .dashboard-grid {
            display: grid;
            grid-template-columns: 1fr 400px;
            gap: 20px;
        }

        /* Cards */
        .card {
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: 10px;
            overflow: hidden;
        }

        .card-header {
            padding: 14px 18px;
            border-bottom: 1px solid var(--border-color);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .card-header h2 {
            font-size: 14px;
            font-weight: 600;
        }

        .card-body {
            padding: 16px;
        }

        /* Timeframe Tabs */
        .timeframe-tabs {
            display: flex;
            gap: 4px;
            background: var(--bg-tertiary);
            padding: 4px;
            border-radius: 6px;
        }

        .timeframe-tab {
            padding: 6px 12px;
            border-radius: 4px;
            font-size: 12px;
            font-weight: 500;
            cursor: pointer;
            color: var(--text-secondary);
            border: none;
            background: transparent;
        }

        .timeframe-tab.active {
            background: var(--accent-blue);
            color: white;
        }

        /* Sector Grid */
        .sector-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 12px;
            margin-bottom: 20px;
        }

        .sector-card {
            background: var(--bg-tertiary);
            border-radius: 8px;
            padding: 14px;
            cursor: pointer;
            transition: all 0.2s;
            border: 2px solid transparent;
        }

        .sector-card:hover {
            border-color: var(--accent-blue);
        }

        .sector-card.selected {
            border-color: var(--accent-blue);
            background: rgba(47, 129, 247, 0.1);
        }

        .sector-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }

        .sector-name {
            font-weight: 600;
            font-size: 14px;
        }

        .sector-ticker {
            font-size: 11px;
            color: var(--text-secondary);
            background: var(--bg-secondary);
            padding: 2px 6px;
            border-radius: 4px;
        }

        .sector-metrics {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 8px;
        }

        .sector-metric {
            text-align: center;
        }

        .sector-metric-value {
            font-size: 16px;
            font-weight: 600;
        }

        .sector-metric-value.positive { color: var(--accent-green); }
        .sector-metric-value.negative { color: var(--accent-red); }

        .sector-metric-label {
            font-size: 10px;
            color: var(--text-secondary);
            text-transform: uppercase;
        }

        /* Relative Strength Bar */
        .rs-bar-container {
            margin-top: 10px;
        }

        .rs-bar {
            height: 4px;
            background: var(--bg-secondary);
            border-radius: 2px;
            overflow: hidden;
        }

        .rs-bar-fill {
            height: 100%;
            border-radius: 2px;
            transition: width 0.3s;
        }

        .rs-bar-fill.leading { background: linear-gradient(90deg, var(--accent-green), var(--accent-cyan)); }
        .rs-bar-fill.improving { background: linear-gradient(90deg, var(--accent-yellow), var(--accent-green)); }
        .rs-bar-fill.weakening { background: linear-gradient(90deg, var(--accent-orange), var(--accent-yellow)); }
        .rs-bar-fill.lagging { background: linear-gradient(90deg, var(--accent-red), var(--accent-orange)); }

        /* Rotation Quadrant Chart */
        .quadrant-container {
            position: relative;
            width: 100%;
            aspect-ratio: 1;
            background: var(--bg-tertiary);
            border-radius: 8px;
            overflow: hidden;
        }

        .quadrant-grid {
            position: absolute;
            inset: 0;
            display: grid;
            grid-template-columns: 1fr 1fr;
            grid-template-rows: 1fr 1fr;
        }

        .quadrant {
            display: flex;
            flex-direction: column;
            justify-content: flex-start;
            align-items: center;
            padding: 10px;
            border: 1px solid var(--border-color);
        }

        .quadrant-label {
            font-size: 11px;
            font-weight: 600;
            text-transform: uppercase;
            margin-bottom: 8px;
        }

        .quadrant.leading { background: rgba(63, 185, 80, 0.08); }
        .quadrant.improving { background: rgba(57, 197, 207, 0.08); }
        .quadrant.weakening { background: rgba(240, 136, 62, 0.08); }
        .quadrant.lagging { background: rgba(248, 81, 73, 0.08); }

        .quadrant-tickers {
            display: flex;
            flex-wrap: wrap;
            gap: 4px;
            justify-content: center;
        }

        .quadrant-ticker {
            padding: 4px 8px;
            background: var(--bg-secondary);
            border-radius: 4px;
            font-size: 11px;
            font-weight: 600;
        }

        .quadrant.leading .quadrant-ticker { color: var(--accent-green); border: 1px solid var(--accent-green); }
        .quadrant.improving .quadrant-ticker { color: var(--accent-cyan); border: 1px solid var(--accent-cyan); }
        .quadrant.weakening .quadrant-ticker { color: var(--accent-orange); border: 1px solid var(--accent-orange); }
        .quadrant.lagging .quadrant-ticker { color: var(--accent-red); border: 1px solid var(--accent-red); }

        .quadrant-axis {
            position: absolute;
            background: var(--border-color);
        }

        .quadrant-axis.horizontal {
            width: 100%;
            height: 2px;
            top: 50%;
            left: 0;
        }

        .quadrant-axis.vertical {
            width: 2px;
            height: 100%;
            left: 50%;
            top: 0;
        }

        .axis-label {
            position: absolute;
            font-size: 10px;
            color: var(--text-secondary);
        }

        .axis-label.left { left: 10px; top: 50%; transform: translateY(-50%); }
        .axis-label.right { right: 10px; top: 50%; transform: translateY(-50%); }
        .axis-label.top { top: 10px; left: 50%; transform: translateX(-50%); }
        .axis-label.bottom { bottom: 10px; left: 50%; transform: translateX(-50%); }

        /* Performance Table */
        .performance-table {
            width: 100%;
            border-collapse: collapse;
        }

        .performance-table th,
        .performance-table td {
            padding: 10px 12px;
            text-align: left;
            border-bottom: 1px solid var(--border-color);
            font-size: 13px;
        }

        .performance-table th {
            background: var(--bg-tertiary);
            font-weight: 600;
            color: var(--text-secondary);
            font-size: 11px;
            text-transform: uppercase;
        }

        .performance-table tr:hover {
            background: var(--bg-tertiary);
        }

        .rank-badge {
            width: 24px;
            height: 24px;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            font-size: 11px;
            font-weight: 600;
        }

        .rank-badge.top3 { background: rgba(63, 185, 80, 0.2); color: var(--accent-green); }
        .rank-badge.bottom3 { background: rgba(248, 81, 73, 0.2); color: var(--accent-red); }

        /* Flow Indicator */
        .flow-indicator {
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .flow-arrow {
            font-size: 14px;
        }

        .flow-arrow.inflow { color: var(--accent-green); }
        .flow-arrow.outflow { color: var(--accent-red); }

        /* Alerts */
        .alert-list {
            max-height: 300px;
            overflow-y: auto;
        }

        .alert-item {
            display: flex;
            gap: 12px;
            padding: 12px;
            border-bottom: 1px solid var(--border-color);
            transition: background 0.2s;
        }

        .alert-item:hover {
            background: var(--bg-tertiary);
        }

        .alert-item:last-child {
            border-bottom: none;
        }

        .alert-icon {
            width: 32px;
            height: 32px;
            border-radius: 6px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 14px;
            flex-shrink: 0;
        }

        .alert-icon.breakout { background: rgba(63, 185, 80, 0.2); }
        .alert-icon.breakdown { background: rgba(248, 81, 73, 0.2); }
        .alert-icon.rotation { background: rgba(47, 129, 247, 0.2); }

        .alert-content {
            flex: 1;
        }

        .alert-title {
            font-size: 13px;
            font-weight: 500;
            margin-bottom: 4px;
        }

        .alert-meta {
            font-size: 11px;
            color: var(--text-secondary);
        }

        /* Heatmap */
        .heatmap-grid {
            display: grid;
            grid-template-columns: repeat(11, 1fr);
            gap: 3px;
        }

        .heatmap-cell {
            aspect-ratio: 1;
            border-radius: 4px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 9px;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.2s;
        }

        .heatmap-cell:hover {
            transform: scale(1.1);
            z-index: 1;
        }

        .heatmap-row-label {
            font-size: 10px;
            color: var(--text-secondary);
            display: flex;
            align-items: center;
            padding-right: 6px;
        }

        /* Sidebar sections */
        .sidebar-section {
            margin-bottom: 20px;
        }

        .sidebar-section:last-child {
            margin-bottom: 0;
        }

        /* Money Flow Chart */
        .flow-bars {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .flow-bar-row {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .flow-bar-label {
            width: 50px;
            font-size: 11px;
            font-weight: 600;
        }

        .flow-bar-track {
            flex: 1;
            height: 20px;
            background: var(--bg-tertiary);
            border-radius: 4px;
            overflow: hidden;
            position: relative;
        }

        .flow-bar-fill {
            height: 100%;
            border-radius: 4px;
            position: absolute;
        }

        .flow-bar-fill.inflow {
            background: linear-gradient(90deg, var(--accent-green), rgba(63, 185, 80, 0.5));
            left: 50%;
        }

        .flow-bar-fill.outflow {
            background: linear-gradient(270deg, var(--accent-red), rgba(248, 81, 73, 0.5));
            right: 50%;
        }

        .flow-bar-center {
            position: absolute;
            left: 50%;
            top: 0;
            bottom: 0;
            width: 2px;
            background: var(--border-color);
        }

        .flow-bar-value {
            width: 60px;
            text-align: right;
            font-size: 12px;
            font-weight: 500;
        }

        .flow-bar-value.positive { color: var(--accent-green); }
        .flow-bar-value.negative { color: var(--accent-red); }

        /* Responsive */
        @media (max-width: 1400px) {
            .dashboard-grid {
                grid-template-columns: 1fr;
            }

            .sector-grid {
                grid-template-columns: repeat(4, 1fr);
            }
        }

        @media (max-width: 900px) {
            .sector-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        /* Scrollbar */
        ::-webkit-scrollbar {
            width: 6px;
        }

        ::-webkit-scrollbar-track {
            background: var(--bg-secondary);
        }

        ::-webkit-scrollbar-thumb {
            background: var(--bg-tertiary);
            border-radius: 3px;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <div class="header">
            <h1>üîÑ Sector Rotation Dashboard</h1>
            <div class="header-meta">
                <div class="market-status">
                    <span class="status-dot"></span>
                    Market Open
                </div>
                <span class="last-update">Last update: <span id="lastUpdate">12:34:56 PM</span></span>
                <button class="btn" onclick="refreshData()">üîÑ Refresh</button>
            </div>
        </div>

        <div class="dashboard-grid">
            <!-- Main Content -->
            <div class="main-content">
                <!-- Sector Performance Grid -->
                <div class="card" style="margin-bottom: 20px;">
                    <div class="card-header">
                        <h2>üìä Sector Performance</h2>
                        <div class="timeframe-tabs">
                            <button class="timeframe-tab" onclick="setTimeframe('1d')">1D</button>
                            <button class="timeframe-tab active" onclick="setTimeframe('1w')">1W</button>
                            <button class="timeframe-tab" onclick="setTimeframe('1m')">1M</button>
                            <button class="timeframe-tab" onclick="setTimeframe('3m')">3M</button>
                            <button class="timeframe-tab" onclick="setTimeframe('ytd')">YTD</button>
                        </div>
                    </div>
                    <div class="card-body">
                        <div class="sector-grid" id="sectorGrid">
                            <!-- Populated by JS -->
                        </div>
                    </div>
                </div>

                <!-- Two Column Layout -->
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                    <!-- Rotation Quadrant -->
                    <div class="card">
                        <div class="card-header">
                            <h2>üéØ Rotation Matrix (RRG)</h2>
                        </div>
                        <div class="card-body">
                            <div class="quadrant-container">
                                <div class="quadrant-grid">
                                    <div class="quadrant leading">
                                        <span class="quadrant-label">Leading</span>
                                        <div class="quadrant-tickers" id="leadingTickers"></div>
                                    </div>
                                    <div class="quadrant improving">
                                        <span class="quadrant-label">Improving</span>
                                        <div class="quadrant-tickers" id="improvingTickers"></div>
                                    </div>
                                    <div class="quadrant lagging">
                                        <span class="quadrant-label">Lagging</span>
                                        <div class="quadrant-tickers" id="laggingTickers"></div>
                                    </div>
                                    <div class="quadrant weakening">
                                        <span class="quadrant-label">Weakening</span>
                                        <div class="quadrant-tickers" id="weakeningTickers"></div>
                                    </div>
                                </div>
                                <div class="quadrant-axis horizontal"></div>
                                <div class="quadrant-axis vertical"></div>
                                <span class="axis-label left">‚Üê Weak RS</span>
                                <span class="axis-label right">Strong RS ‚Üí</span>
                                <span class="axis-label top">‚Üë Improving</span>
                                <span class="axis-label bottom">‚Üì Weakening</span>
                            </div>
                        </div>
                    </div>

                    <!-- Performance Ranking -->
                    <div class="card">
                        <div class="card-header">
                            <h2>üèÜ Relative Strength Ranking</h2>
                        </div>
                        <div class="card-body" style="padding: 0;">
                            <table class="performance-table">
                                <thead>
                                    <tr>
                                        <th>Rank</th>
                                        <th>Sector</th>
                                        <th>Return</th>
                                        <th>RS Score</th>
                                        <th>Flow</th>
                                    </tr>
                                </thead>
                                <tbody id="rankingTable">
                                    <!-- Populated by JS -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <!-- Money Flow -->
                <div class="card" style="margin-top: 20px;">
                    <div class="card-header">
                        <h2>üí∞ Weekly Money Flow</h2>
                    </div>
                    <div class="card-body">
                        <div class="flow-bars" id="flowBars">
                            <!-- Populated by JS -->
                        </div>
                    </div>
                </div>
            </div>

            <!-- Sidebar -->
            <div class="sidebar">
                <!-- Alerts -->
                <div class="card sidebar-section">
                    <div class="card-header">
                        <h2>üîî Rotation Alerts</h2>
                        <span style="color: var(--accent-yellow); font-size: 12px;">3 new</span>
                    </div>
                    <div class="alert-list" id="alertList">
                        <!-- Populated by JS -->
                    </div>
                </div>

                <!-- Sector Correlation Heatmap -->
                <div class="card sidebar-section">
                    <div class="card-header">
                        <h2>üå°Ô∏è Correlation Heatmap</h2>
                    </div>
                    <div class="card-body">
                        <div id="heatmap" class="heatmap-grid">
                            <!-- Populated by JS -->
                        </div>
                    </div>
                </div>

                <!-- Historical Rotation -->
                <div class="card sidebar-section">
                    <div class="card-header">
                        <h2>üìÖ Rotation History</h2>
                    </div>
                    <div class="card-body">
                        <div id="rotationHistory">
                            <!-- Populated by JS -->
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Sector data
        const sectors = [
            { ticker: 'XLK', name: 'Technology', return: 4.2, rs: 78, flow: 2.4, quadrant: 'leading' },
            { ticker: 'XLC', name: 'Comm Services', return: 3.1, rs: 72, flow: 1.8, quadrant: 'leading' },
            { ticker: 'XLY', name: 'Cons Discretionary', return: 2.8, rs: 65, flow: 0.9, quadrant: 'improving' },
            { ticker: 'XLF', name: 'Financials', return: 1.9, rs: 58, flow: 1.2, quadrant: 'improving' },
            { ticker: 'XLI', name: 'Industrials', return: 1.2, rs: 52, flow: 0.4, quadrant: 'improving' },
            { ticker: 'XLV', name: 'Healthcare', return: 0.8, rs: 45, flow: -0.3, quadrant: 'weakening' },
            { ticker: 'XLB', name: 'Materials', return: 0.4, rs: 42, flow: -0.5, quadrant: 'weakening' },
            { ticker: 'XLRE', name: 'Real Estate', return: -0.2, rs: 38, flow: -0.8, quadrant: 'weakening' },
            { ticker: 'XLP', name: 'Cons Staples', return: -0.8, rs: 32, flow: -1.2, quadrant: 'lagging' },
            { ticker: 'XLU', name: 'Utilities', return: -1.4, rs: 25, flow: -1.8, quadrant: 'lagging' },
            { ticker: 'XLE', name: 'Energy', return: -2.1, rs: 18, flow: -2.4, quadrant: 'lagging' },
        ];

        const alerts = [
            { type: 'rotation', ticker: 'XLY', message: 'Moved from Weakening to Improving quadrant', time: '2h ago' },
            { type: 'breakout', ticker: 'XLK', message: 'Broke above 50-day RS moving average', time: '4h ago' },
            { type: 'breakdown', ticker: 'XLE', message: 'Lost sector leadership, dropped to Lagging', time: '6h ago' },
            { type: 'rotation', ticker: 'XLF', message: 'Relative strength improving rapidly', time: '1d ago' },
            { type: 'breakout', ticker: 'XLC', message: 'New 52-week relative high vs SPY', time: '1d ago' },
        ];

        // Render sector grid
        function renderSectorGrid() {
            const grid = document.getElementById('sectorGrid');
            grid.innerHTML = sectors.map((s, i) => `
                <div class="sector-card" onclick="selectSector('${s.ticker}')">
                    <div class="sector-header">
                        <span class="sector-name">${s.name}</span>
                        <span class="sector-ticker">${s.ticker}</span>
                    </div>
                    <div class="sector-metrics">
                        <div class="sector-metric">
                            <div class="sector-metric-value ${s.return >= 0 ? 'positive' : 'negative'}">
                                ${s.return >= 0 ? '+' : ''}${s.return.toFixed(1)}%
                            </div>
                            <div class="sector-metric-label">Return</div>
                        </div>
                        <div class="sector-metric">
                            <div class="sector-metric-value">${s.rs}</div>
                            <div class="sector-metric-label">RS Score</div>
                        </div>
                    </div>
                    <div class="rs-bar-container">
                        <div class="rs-bar">
                            <div class="rs-bar-fill ${s.quadrant}" style="width: ${s.rs}%"></div>
                        </div>
                    </div>
                </div>
            `).join('');
        }

        // Render rotation quadrants
        function renderQuadrants() {
            const quadrants = {
                leading: document.getElementById('leadingTickers'),
                improving: document.getElementById('improvingTickers'),
                weakening: document.getElementById('weakeningTickers'),
                lagging: document.getElementById('laggingTickers'),
            };

            Object.keys(quadrants).forEach(q => {
                const tickers = sectors.filter(s => s.quadrant === q);
                quadrants[q].innerHTML = tickers.map(t => 
                    `<span class="quadrant-ticker">${t.ticker}</span>`
                ).join('');
            });
        }

        // Render ranking table
        function renderRankingTable() {
            const sorted = [...sectors].sort((a, b) => b.rs - a.rs);
            const table = document.getElementById('rankingTable');
            
            table.innerHTML = sorted.map((s, i) => {
                const rank = i + 1;
                const rankClass = rank <= 3 ? 'top3' : (rank >= 9 ? 'bottom3' : '');
                const flowClass = s.flow >= 0 ? 'inflow' : 'outflow';
                
                return `
                    <tr>
                        <td><span class="rank-badge ${rankClass}">${rank}</span></td>
                        <td><strong>${s.ticker}</strong> <span style="color: var(--text-secondary)">${s.name}</span></td>
                        <td class="${s.return >= 0 ? 'positive' : 'negative'}" style="color: var(${s.return >= 0 ? '--accent-green' : '--accent-red'})">
                            ${s.return >= 0 ? '+' : ''}${s.return.toFixed(1)}%
                        </td>
                        <td>${s.rs}</td>
                        <td>
                            <div class="flow-indicator">
                                <span class="flow-arrow ${flowClass}">${s.flow >= 0 ? '‚Üë' : '‚Üì'}</span>
                                <span style="color: var(${s.flow >= 0 ? '--accent-green' : '--accent-red'})">${Math.abs(s.flow).toFixed(1)}B</span>
                            </div>
                        </td>
                    </tr>
                `;
            }).join('');
        }

        // Render flow bars
        function renderFlowBars() {
            const container = document.getElementById('flowBars');
            const sorted = [...sectors].sort((a, b) => b.flow - a.flow);
            const maxFlow = Math.max(...sectors.map(s => Math.abs(s.flow)));
            
            container.innerHTML = sorted.map(s => {
                const width = (Math.abs(s.flow) / maxFlow) * 50;
                const isInflow = s.flow >= 0;
                
                return `
                    <div class="flow-bar-row">
                        <span class="flow-bar-label">${s.ticker}</span>
                        <div class="flow-bar-track">
                            <div class="flow-bar-center"></div>
                            <div class="flow-bar-fill ${isInflow ? 'inflow' : 'outflow'}" 
                                 style="width: ${width}%"></div>
                        </div>
                        <span class="flow-bar-value ${isInflow ? 'positive' : 'negative'}">
                            ${isInflow ? '+' : ''}${s.flow.toFixed(1)}B
                        </span>
                    </div>
                `;
            }).join('');
        }

        // Render alerts
        function renderAlerts() {
            const list = document.getElementById('alertList');
            list.innerHTML = alerts.map(a => `
                <div class="alert-item">
                    <div class="alert-icon ${a.type}">
                        ${a.type === 'breakout' ? 'üìà' : (a.type === 'breakdown' ? 'üìâ' : 'üîÑ')}
                    </div>
                    <div class="alert-content">
                        <div class="alert-title"><strong>${a.ticker}</strong> - ${a.message}</div>
                        <div class="alert-meta">${a.time}</div>
                    </div>
                </div>
            `).join('');
        }

        // Render correlation heatmap
        function renderHeatmap() {
            const container = document.getElementById('heatmap');
            const tickers = sectors.map(s => s.ticker);
            
            // Generate correlation values (mock data)
            const getCorrelation = (i, j) => {
                if (i === j) return 1;
                const base = 0.3 + Math.random() * 0.5;
                // Similar sectors have higher correlation
                if (Math.abs(i - j) <= 2) return 0.6 + Math.random() * 0.3;
                return base;
            };
            
            const getHeatColor = (val) => {
                if (val >= 0.8) return 'rgba(63, 185, 80, 0.8)';
                if (val >= 0.6) return 'rgba(63, 185, 80, 0.5)';
                if (val >= 0.4) return 'rgba(210, 153, 34, 0.5)';
                if (val >= 0.2) return 'rgba(240, 136, 62, 0.5)';
                return 'rgba(248, 81, 73, 0.5)';
            };
            
            let html = '';
            for (let i = 0; i < tickers.length; i++) {
                for (let j = 0; j < tickers.length; j++) {
                    const corr = getCorrelation(i, j);
                    html += `<div class="heatmap-cell" style="background: ${getHeatColor(corr)}" 
                                  title="${tickers[i]} vs ${tickers[j]}: ${corr.toFixed(2)}">
                                ${i === j ? tickers[i].slice(-1) : ''}
                             </div>`;
                }
            }
            container.innerHTML = html;
        }

        // Render rotation history
        function renderRotationHistory() {
            const container = document.getElementById('rotationHistory');
            const history = [
                { date: 'Jan 27', from: 'XLY', fromQ: 'Weakening', to: 'Improving' },
                { date: 'Jan 24', from: 'XLE', fromQ: 'Weakening', to: 'Lagging' },
                { date: 'Jan 22', from: 'XLK', fromQ: 'Improving', to: 'Leading' },
                { date: 'Jan 20', from: 'XLV', fromQ: 'Improving', to: 'Weakening' },
            ];
            
            container.innerHTML = history.map(h => `
                <div style="display: flex; align-items: center; gap: 10px; padding: 8px 0; border-bottom: 1px solid var(--border-color);">
                    <span style="color: var(--text-secondary); font-size: 11px; width: 50px;">${h.date}</span>
                    <span style="font-weight: 600; color: var(--accent-blue);">${h.from}</span>
                    <span style="color: var(--text-secondary);">‚Üí</span>
                    <span style="color: var(--accent-cyan);">${h.to}</span>
                </div>
            `).join('');
        }

        // Timeframe switching
        function setTimeframe(tf) {
            document.querySelectorAll('.timeframe-tab').forEach(t => t.classList.remove('active'));
            event.target.classList.add('active');
            // In production: fetch new data for timeframe
        }

        function selectSector(ticker) {
            document.querySelectorAll('.sector-card').forEach(c => c.classList.remove('selected'));
            event.currentTarget.classList.add('selected');
        }

        function refreshData() {
            document.getElementById('lastUpdate').textContent = new Date().toLocaleTimeString();
        }

        // Initialize
        renderSectorGrid();
        renderQuadrants();
        renderRankingTable();
        renderFlowBars();
        renderAlerts();
        renderHeatmap();
        renderRotationHistory();

        // Update time
        setInterval(() => {
            document.getElementById('lastUpdate').textContent = new Date().toLocaleTimeString();
        }, 60000);
    </script>
</body>
</html>
